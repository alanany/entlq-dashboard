<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        body { font-family: 'Tajawal', sans-serif; }
        /* ğŸ’¡ ÙƒÙˆØ¯ Ø§Ù„Ù€ Spinner */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            width: 1.5rem;
            height: 1.5rem;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div class="flex h-screen overflow-hidden">
        
        <aside class="w-64 bg-white border-l border-gray-200 hidden md:flex flex-col">
            <div class="h-16 flex items-center justify-center border-b border-gray-200">
                <h1 class="text-2xl font-bold text-indigo-600">Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù†Ø·Ù„Ù‚</h1>
            </div>
            <nav class="flex-1 px-4 py-6 space-y-2">
                <a href="/" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg">
                    <i data-feather="home" class="ml-3 w-5 h-5"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                </a>
                <a href="/courses" class="flex items-center px-4 py-3 bg-indigo-50 text-indigo-600 rounded-lg">
                    <i data-feather="book-open" class="ml-3 w-5 h-5"></i> Ø§Ù„Ø¯ÙˆØ±Ø§Øª
                </a>
            </nav>
        </aside>

        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8">
                <div class="flex items-center gap-2 text-gray-500">
                    <a href="/courses" class="hover:text-indigo-600">Ø§Ù„Ø¯ÙˆØ±Ø§Øª</a>
                    <span>/</span>
                    <span class="text-gray-800 font-bold">Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
                </div>
                <div class="flex gap-3">
                    <button type="button" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 text-sm">Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©</button>
                    <button id="publishBtn" type="submit" form="courseForm" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 text-sm flex items-center transition-colors">
                        Ù†Ø´Ø± Ø§Ù„Ø¯ÙˆØ±Ø©
                        <div id="spinner" class="spinner mr-2 hidden"></div>
                    </button>
                </div>
            </header>

            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-8">
                <div class="max-w-4xl mx-auto">
                    <form id="courseForm" onsubmit="handleSubmit(event)" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        
                        <div class="md:col-span-2 space-y-6">
                            
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <h3 class="font-bold text-lg mb-4 text-gray-800">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label for="title" class="block text-sm font-medium text-gray-700 mb-1">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø©</label>
                                        <input type="text" id="title" name="title" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none" placeholder="Ù…Ø«Ø§Ù„: ØªØ¹Ù„Ù… Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø±Ø§ÙÙŠÙƒÙŠ Ù…Ù† Ø§Ù„ØµÙØ±">
                                    </div>
                                    <div>
                                        <label for="description" class="block text-sm font-medium text-gray-700 mb-1">ÙˆØµÙ Ù‚ØµÙŠØ±</label>
                                        <textarea id="description" name="description" rows="4" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none" placeholder="Ø§ÙƒØªØ¨ Ù†Ø¨Ø°Ø© Ù…Ø®ØªØµØ±Ø© ØªØ¬Ø°Ø¨ Ø§Ù„Ø·Ù„Ø§Ø¨..."></textarea>
                                    </div>
                                </div>
                                   <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <h3 class="font-bold text-sm mb-3 text-gray-800">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø©</h3>
                                <div class="space-y-3">
                                   <h3 class="font-bold text-xl mb-4 text-indigo-600 border-b pb-2 mt-8">ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ³Ø¹ÙŠØ±</h3>

<div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6">
    <p class="font-bold text-gray-800 mb-3">Ø­Ø¯Ø¯ Ø³Ø¹Ø± Ø§Ù„Ø­ØµØ© Ù„ÙƒÙ„ Ù…Ø¯Ø© Ø²Ù…Ù†ÙŠØ©:</p>
    
    <div class="grid grid-cols-3 gap-4">
        
        <div>
            <label for="price30min" class="block text-sm font-medium text-gray-700 mb-1">Ø³Ø¹Ø± Ø­ØµØ© (30 Ø¯Ù‚ÙŠÙ‚Ø©) SAR</label>
            <input type="number" id="price30min" name="price30min"  required min="1" 
                   class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
        </div>

        <div>
            <label for="price40min" class="block text-sm font-medium text-gray-700 mb-1">Ø³Ø¹Ø± Ø­ØµØ© (40 Ø¯Ù‚ÙŠÙ‚Ø©) SAR</label>
            <input type="number" id="price40min" name="price40min" required min="1" 
                   class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
        </div>
        
        <div>
            <label for="price60min" class="block text-sm font-medium text-gray-700 mb-1">Ø³Ø¹Ø± Ø­ØµØ© (60 Ø¯Ù‚ÙŠÙ‚Ø©) SAR</label>
            <input type="number" id="price60min" name="price60min"  required min="1" 
                   class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
        </div>
    </div>
</div>


                                    <div>
                                        <label for="level" class="block text-xs font-medium text-gray-700 mb-1">Ø§Ù„Ù…Ø³ØªÙˆÙ‰</label>
                                        <select id="level" name="level" required class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-white">
                                            <option value="beginner">Ù…Ø¨ØªØ¯Ø¦</option>
                                            <option value="intermediate">Ù…ØªÙˆØ³Ø·</option>
                                            <option value="advanced">Ù…ØªÙ‚Ø¯Ù…</option>
                                        </select>
                                    </div>
                                  <div class="mb-6">
    <label for="category" class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</label>
    <select id="category" name="category" required 
            class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
        
        <option value="" disabled selected>-- Ø§Ø®ØªØ± Ù‚Ø³Ù…Ø§Ù‹ --</option>
        
        <% if (categories && categories.length > 0) { %>
            <% categories.forEach(category => { %>
                <option value="<%= category._id %>">
                    <%= category.name %>
                </option>
            <% }); %>
        <% } else { %>
             <option value="" disabled>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‚Ø³Ø§Ù… Ù…ØªØ§Ø­Ø©</option>
        <% } %>
        
    </select>
</div>
                                </div>
                            </div>
                            </div>

                            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="font-bold text-lg text-gray-800">Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</h3>
                                    <button type="button" onclick="addSection()" class="text-sm text-indigo-600 font-medium hover:underline">+ Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯</button>
                                </div>
                                
                                <div id="curriculumContainer" class="space-y-3">
                                    </div>
                            </div>
                        </div>
                        
                        <div class="space-y-6">
                            
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <h3 class="font-bold text-sm mb-3 text-gray-800">ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù</h3>
                                
                                <div class="relative border-2 border-dashed border-gray-300 rounded-lg p-6 flex flex-col items-center justify-center text-center hover:bg-gray-50 transition-colors cursor-pointer">
                                    <i data-feather="image" class="w-8 h-8 text-gray-400 mb-2"></i>
                                    <span class="text-xs text-gray-500">Ø§Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ø¶ØºØ· Ù„Ù„Ø±ÙØ¹</span>
                                    <input type="file" id="coverImage" name="coverImage" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                                </div>
                            </div>

                        

                        </div>
                    </form>
                </div>
            </main>
        </div>
    </div>
    
    <div id="toastContainer" class="fixed bottom-4 right-4 z-[70] space-y-3"></div>

    <script>
        feather.replace();

        const form = document.getElementById("courseForm");
        const publishBtn = document.getElementById("publishBtn");
        const originalButtonText = 'Ù†Ø´Ø± Ø§Ù„Ø¯ÙˆØ±Ø©'; 
        let sectionCounter = 0; // ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ù…Ù† 0

        // ----------------- Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -----------------
        
        function startLoading() {
            publishBtn.disabled = true;
            publishBtn.innerHTML = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø±... <div class="spinner mr-2"></div>';
        }

        function stopLoading() {
            publishBtn.disabled = false;
            publishBtn.innerHTML = originalButtonText;
            feather.replace(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
        }

      // ----------------- Ø¯Ø§Ù„Ø© Toast Notification -----------------
function showToast(message, type = 'info', duration = 4000) {
    const toastContainer = document.getElementById('toastContainer');
    
    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
    let bgColor, icon;
    switch (type) {
        case 'success':
            bgColor = 'bg-green-600';
            icon = 'check-circle';
            break;
        case 'error':
            bgColor = 'bg-red-600';
            icon = 'x-octagon';
            break;
        case 'info':
        default:
            bgColor = 'bg-blue-500';
            icon = 'info';
            break;
    }

    // 1. Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± (Toast)
    const toast = document.createElement('div');
    toast.className = `p-4 rounded-lg shadow-xl text-white ${bgColor} flex items-center transition-all duration-300 transform translate-x-0 opacity-100 max-w-sm w-full`;
    toast.style.opacity = '0';
    toast.style.transform = 'translateX(100%)';
    
    // 2. Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± (Ù…Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©)
    toast.innerHTML = `
        <i data-feather="${icon}" class="w-5 h-5 ml-3 flex-shrink-0"></i>
        <span class="text-sm font-medium">${message}</span>
    `;

    // 3. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙˆÙŠØ©
    toastContainer.appendChild(toast);
    
    // 4. ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª (Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Feather)
    feather.replace();

    // 5. Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± (Ø§Ù†ØªÙ‚Ø§Ù„ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ†)
    setTimeout(() => {
        toast.style.opacity = '1';
        toast.style.transform = 'translateX(0)';
    }, 50);

    // 6. Ø¥Ø®ÙØ§Ø¡ ÙˆØ¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯
    setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';

        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù† DOM Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
        toast.addEventListener('transitionend', () => {
            toast.remove();
        });
    }, duration);
}
// -----------------------------------------------------------

        // ----------------- Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ -----------------

        /**
         * Ø¯Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨ (Template) Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯
         */
        function createSectionTemplate() {
            sectionCounter++;
            const sectionIndex = sectionCounter;
            
            return `
                <div class="section-item border border-gray-200 rounded-lg p-4 bg-gray-50" data-section-index="${sectionIndex}">
                    <div class="flex justify-between items-center mb-3">
                        <input type="text" name="sectionTitle_${sectionIndex}" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø³Ù… ${sectionIndex}" class="font-bold text-gray-700 bg-transparent border-none focus:outline-none focus:ring-0 w-full ml-4" value="Ø§Ù„Ù‚Ø³Ù… ${sectionIndex}:">
                        <div class="flex items-center gap-2">
                            <button type="button" onclick="removeElement(this)" class="text-gray-400 hover:text-red-500"><i data-feather="trash" class="w-4 h-4"></i></button>
                            <i data-feather="move" class="w-4 h-4 text-gray-400 cursor-move"></i>
                        </div>
                    </div>
                    
                    <div class="lessons-container space-y-2 pl-4 border-r-2 border-gray-200 mr-2 pr-4">
                        
                        <button type="button" onclick="addLesson(this)" class="w-full py-2 border border-dashed border-gray-300 rounded text-gray-500 text-sm hover:bg-gray-100 mt-2">+ Ø¥Ø¶Ø§ÙØ© Ø¯Ø±Ø³</button>
                    </div>
                </div>
            `;
        }

        /**
         * Ø¯Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨ (Template) Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¯Ø±Ø³ Ø¬Ø¯ÙŠØ¯
         */
        function createLessonTemplate(sectionIndex, lessonIndex) {
            return `
                <div class="lesson-item flex items-center justify-between bg-white p-2 rounded border border-gray-100" data-lesson-index="${lessonIndex}">
                    <div class="flex items-center gap-2 w-full">
                        <i data-feather="play-circle" class="w-4 h-4 text-gray-400 flex-shrink-0"></i>
                        <input type="text" name="section_${sectionIndex}_lessonTitle_${lessonIndex}" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³" required class="text-sm border-none focus:outline-none focus:ring-0 w-full">
                    </div>
                    <button type="button" onclick="removeElement(this)" class="text-gray-400 hover:text-red-500 flex-shrink-0 mr-2"><i data-feather="trash" class="w-3 h-3"></i></button>
                </div>
            `;
        }

        /**
         * Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ
         */
        function addSection() {
            const container = document.getElementById('curriculumContainer');
            const template = createSectionTemplate();
            container.insertAdjacentHTML('beforeend', template);
            feather.replace(); // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Feather
        }

        /**
         * Ø¥Ø¶Ø§ÙØ© Ø¯Ø±Ø³ Ø¬Ø¯ÙŠØ¯ Ø¶Ù…Ù† Ù‚Ø³Ù… Ù…Ø¹ÙŠÙ†
         * @param {HTMLElement} button - Ø²Ø± "+ Ø¥Ø¶Ø§ÙØ© Ø¯Ø±Ø³" Ø§Ù„Ø°ÙŠ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„ÙŠÙ‡.
         */
        function addLesson(button) {
            const sectionDiv = button.closest('.section-item');
            const sectionIndex = sectionDiv.dataset.sectionIndex;
            const lessonsContainer = sectionDiv.querySelector('.lessons-container');
            
            // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø£Ø¨ÙˆÙŠØ©
            const currentLessons = lessonsContainer.querySelectorAll('.lesson-item').length;
            const lessonIndex = currentLessons + 1;
            
            const template = createLessonTemplate(sectionIndex, lessonIndex);
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø±Ø³ Ù‚Ø¨Ù„ Ø²Ø± "+ Ø¥Ø¶Ø§ÙØ© Ø¯Ø±Ø³" (Ù„Ø¥Ø¨Ù‚Ø§Ø¦Ù‡ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„)
            button.insertAdjacentHTML('beforebegin', template);
            feather.replace();
        }

        /**
         * Ø¯Ø§Ù„Ø© Ø¹Ø§Ù…Ø© Ù„Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø£Ø¨ (Ù‚Ø³Ù… Ø£Ùˆ Ø¯Ø±Ø³)
         * @param {HTMLElement} button - Ø²Ø± Ø§Ù„Ø­Ø°Ù
         */
        function removeElement(button) {
            const elementToRemove = button.closest('.section-item') || button.closest('.lesson-item');
            if (elementToRemove) {
                elementToRemove.remove();
                // Ù„Ø§ Ù†Ø­ØªØ§Ø¬ Ù„Ø¶Ø¨Ø· sectionCounter Ù‡Ù†Ø§ØŒ ÙÙ‚Ø· Ù†Ø­Ø°Ù Ø§Ù„Ø¹Ù†ØµØ±
            }
        }

        // ----------------- Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Handle Submit) -----------------

        async function handleSubmit(event) {
            event.preventDefault(); 
            
            startLoading();

   
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¬Ø³Ù… Ø§Ù„Ø·Ù„Ø¨
            const form = event.target;
            const formData = new FormData(form);
            const pricingOptions1 = [
        { duration: 30, price: parseFloat(formData.get('price30min')) },
        { duration: 40, price: parseFloat(formData.get('price40min')) },
        { duration: 60, price: parseFloat(formData.get('price60min')) },
    ];
    console.log(pricingOptions1);
            // 1. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            const courseData = {
                
                title: formData.get('title'),
                description: formData.get('description'),
               // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø³Ø¹Ø± Ù„Ø±Ù‚Ù…
                level: formData.get('level'),
                pricingOptions:pricingOptions1,
                category: formData.get('category'),
                curriculum: [] // Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ
            };

            // 2. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ (Curriculum)
            const sections = document.querySelectorAll('#curriculumContainer .section-item');
            
            sections.forEach(sectionDiv => {
                const sectionData = {
                    // Ø¬Ù„Ø¨ Ù‚ÙŠÙ…Ø© input Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø³Ù…
                    title: sectionDiv.querySelector('input[type="text"]').value, 
                    lessons: []
                };

                // Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø­Ù‚ÙˆÙ„ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¯Ø±Ø³ Ø¯Ø§Ø®Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…
                const lessonInputs = sectionDiv.querySelectorAll('.lessons-container .lesson-item input[type="text"]');
                
                lessonInputs.forEach(input => {
                    if(input.value.trim() !== "") {
                         sectionData.lessons.push({
                            title: input.value.trim(),
                            // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ Ù„Ø§Ø­Ù‚Ø§Ù‹
                        });
                    }
                });
                
                courseData.curriculum.push(sectionData);
            });

            const endpoint = '/addCourse-post'; 

            console.log("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©:", courseData); 


            try {
                // ... (Ù…Ù†Ø·Ù‚ fetch API Ù„Ù„Ø¥Ø±Ø³Ø§Ù„) ...
                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }, 
                    body: JSON.stringify(courseData) 
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw errorData; 
                }

                stopLoading();
                showToast("ØªÙ… Ù†Ø´Ø± Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!", 'success');
                // Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­
                setTimeout(() => { window.location.href = '/courses'; }, 1000);

            } catch (error) {
                stopLoading();
                console.error("Ø®Ø·Ø£ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:", error); 
                const errorMessage = error?.message || "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù†Ø´Ø±. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.";
                showToast("Ø®Ø·Ø£: " + errorMessage, 'error');
            }

        }

        // â­ï¸ Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© â­ï¸
        document.addEventListener('DOMContentLoaded', () => {
             feather.replace();
             // Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ ÙˆØ§Ø­Ø¯ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø­Ø§ÙˆÙŠØ© ÙØ§Ø±ØºØ© ØªÙ…Ø§Ù…Ø§Ù‹
             if (document.getElementById('curriculumContainer').children.length === 0) {
                 addSection();
             }
        });
    </script>
</body>
</html>